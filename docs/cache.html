<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>freshlinks.cache API documentation</title>
<meta name="description" content="Cache URL response." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>freshlinks.cache</code></h1>
</header>
<section id="section-intro">
<p>Cache URL response.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;Cache URL response.&#34;&#34;&#34;

# native
from __future__ import annotations
from dataclasses import dataclass
from dataclasses import field
from datetime import datetime
from datetime import timedelta
from hashlib import sha256
from pathlib import Path
from time import time
from typing import Dict
from typing import Any
from typing import List
from typing import Optional
from typing import Union
import re

# lib
import ujson

StrOrPath = Union[str, Path]
&#34;&#34;&#34;`str` or `Path`.&#34;&#34;&#34;

DEFAULT_PATH: StrOrPath = &#34;~/.cache/freshlinks&#34;
&#34;&#34;&#34;Default cache folder.&#34;&#34;&#34;

RE_DURATION = re.compile(r&#34;(\d+(?:\.\d+)?)[ ]*([dhms])&#34;)
&#34;&#34;&#34;Pattern for time strings.&#34;&#34;&#34;

DURATION_UNITS = {
    &#34;d&#34;: &#34;days&#34;,
    &#34;h&#34;: &#34;hours&#34;,
    &#34;m&#34;: &#34;minutes&#34;,
    &#34;s&#34;: &#34;seconds&#34;,
}
&#34;&#34;&#34;Time string units.&#34;&#34;&#34;


def to_timedelta(duration: str) -&gt; timedelta:
    &#34;&#34;&#34;Convert a time duration string into a `timedelta`.&#34;&#34;&#34;
    parts = re.findall(RE_DURATION, duration.lower())
    args = {&#34;days&#34;: 0.0, &#34;hours&#34;: 0.0, &#34;minutes&#34;: 0.0, &#34;seconds&#34;: 0.0}
    for value, unit in parts:
        args[DURATION_UNITS.get(unit, &#34;seconds&#34;)] += float(value)
    return timedelta(**args)


def age_time(age: str, start: Optional[datetime] = None) -&gt; int:
    &#34;&#34;&#34;Return unix time relative to a start date.

    Args:
        age (str): amount of time; a number followed by a time unit
            (s=seconds, m=minutes, h=hours, d=days). `s` is default.

        start (datetime, optional): start date from which to subtract `age`.
            If `None` uses `datetime.now()`. Defaults to `None`.

    Returns:
        int: unix time relative to `start`
    &#34;&#34;&#34;
    return int(((start or datetime.now()) - to_timedelta(age)).timestamp())


def hash_url(url: str) -&gt; str:
    &#34;&#34;&#34;Return the hash for a given `url`.&#34;&#34;&#34;
    return sha256(url.encode(&#34;utf-8&#34;)).hexdigest()


@dataclass
class LinkEntry:
    is_cached: bool = False
    &#34;&#34;&#34;Did this entry come from a cache?&#34;&#34;&#34;

    version: int = 1
    &#34;&#34;&#34;Entry format version.&#34;&#34;&#34;

    time: int = 0
    code: int = 200
    err: str = &#34;&#34;
    url: str = &#34;&#34;
    links: List[str] = field(default_factory=list)

    @staticmethod
    def load(data: Dict[str, Any]) -&gt; LinkEntry:
        return LinkEntry(
            is_cached=True,
            version=data[&#34;v&#34;],
            time=data[&#34;t&#34;],
            code=data[&#34;c&#34;],
            err=data.get(&#34;err&#34;, &#34;&#34;),
            url=data[&#34;url&#34;],
            links=data[&#34;links&#34;],
        )

    @property
    def ok(self) -&gt; bool:
        return self.code in [200, 301, 302]

    @property
    def json(self) -&gt; Dict[str, Any]:
        return dict(
            v=self.version,
            t=self.time,
            c=self.code,
            err=self.err,
            url=self.url,
            links=self.links,
        )


class LinkCache:
    &#34;&#34;&#34;A file-based cache for storing metadata about URLs.&#34;&#34;&#34;

    path: Path
    &#34;&#34;&#34;Cache folder.&#34;&#34;&#34;

    max_time: int = 0
    &#34;&#34;&#34;Cache entries older than this are considered invalid.&#34;&#34;&#34;

    def __init__(
        self,
        store: Dict[str, LinkEntry],
        max_time: int = 0,
        path: StrOrPath = DEFAULT_PATH,
        preload: bool = False,
    ):
        self.store = store
        self.max_time = max_time if max_time &gt; 0 else int(time())
        self.path = Path(path).expanduser()
        self.path.mkdir(exist_ok=True)  # ensure cache folder exists
        if preload:
            self.preload()

    def preload(self) -&gt; None:
        for item in self.path.glob(&#34;*.json&#34;):
            self.load(item.stem)

    def load(self, hashed: str) -&gt; Optional[LinkEntry]:
        path = self.path / f&#34;{hashed}.json&#34;
        if not path.exists():
            return None

        data = ujson.loads(path.read_text())
        if data.get(&#34;t&#34;, 0) &lt; self.max_time:
            return None

        entry = LinkEntry.load(data)
        self.store[entry.url] = entry
        return entry

    def __contains__(self, url: str) -&gt; bool:
        return url in self.store or (self.path / f&#34;{hash_url(url)}.json&#34;).exists()

    def __getitem__(self, url: str) -&gt; Optional[LinkEntry]:
        try:
            return self.store[url]
        except KeyError:
            return self.load(hash_url(url))

    def __setitem__(self, url: str, entry: LinkEntry) -&gt; None:
        self.store[url] = entry
        if entry:
            (self.path / f&#34;{hash_url(url)}.json&#34;).write_text(
                ujson.dumps(
                    entry.json,
                    ensure_ascii=False,
                    escape_forward_slashes=False,
                )
            )</code></pre>
</details>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-variables">Global variables</h2>
<dl>
<dt id="freshlinks.cache.StrOrPath"><code class="name">var <span class="ident">StrOrPath</span></code></dt>
<dd>
<div class="desc"><p><code>str</code> or <code>Path</code>.</p></div>
</dd>
<dt id="freshlinks.cache.DEFAULT_PATH"><code class="name">var <span class="ident">DEFAULT_PATH</span> : Union[str, pathlib.Path]</code></dt>
<dd>
<div class="desc"><p>Default cache folder.</p></div>
</dd>
<dt id="freshlinks.cache.RE_DURATION"><code class="name">var <span class="ident">RE_DURATION</span></code></dt>
<dd>
<div class="desc"><p>Pattern for time strings.</p></div>
</dd>
<dt id="freshlinks.cache.DURATION_UNITS"><code class="name">var <span class="ident">DURATION_UNITS</span></code></dt>
<dd>
<div class="desc"><p>Time string units.</p></div>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="freshlinks.cache.to_timedelta"><code class="name flex">
<span>def <span class="ident">to_timedelta</span></span>(<span>duration: str) ‑> datetime.timedelta</span>
</code></dt>
<dd>
<div class="desc"><p>Convert a time duration string into a <code>timedelta</code>.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_timedelta(duration: str) -&gt; timedelta:
    &#34;&#34;&#34;Convert a time duration string into a `timedelta`.&#34;&#34;&#34;
    parts = re.findall(RE_DURATION, duration.lower())
    args = {&#34;days&#34;: 0.0, &#34;hours&#34;: 0.0, &#34;minutes&#34;: 0.0, &#34;seconds&#34;: 0.0}
    for value, unit in parts:
        args[DURATION_UNITS.get(unit, &#34;seconds&#34;)] += float(value)
    return timedelta(**args)</code></pre>
</details>
</dd>
<dt id="freshlinks.cache.age_time"><code class="name flex">
<span>def <span class="ident">age_time</span></span>(<span>age: str, start: Optional[datetime] = None) ‑> int</span>
</code></dt>
<dd>
<div class="desc"><p>Return unix time relative to a start date.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>age</code></strong> :&ensp;<code>str</code></dt>
<dd>amount of time; a number followed by a time unit
(s=seconds, m=minutes, h=hours, d=days). <code>s</code> is default.</dd>
<dt><strong><code>start</code></strong> :&ensp;<code>datetime</code>, optional</dt>
<dd>start date from which to subtract <code>age</code>.
If <code>None</code> uses <code>datetime.now()</code>. Defaults to <code>None</code>.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>unix time relative to <code>start</code></dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def age_time(age: str, start: Optional[datetime] = None) -&gt; int:
    &#34;&#34;&#34;Return unix time relative to a start date.

    Args:
        age (str): amount of time; a number followed by a time unit
            (s=seconds, m=minutes, h=hours, d=days). `s` is default.

        start (datetime, optional): start date from which to subtract `age`.
            If `None` uses `datetime.now()`. Defaults to `None`.

    Returns:
        int: unix time relative to `start`
    &#34;&#34;&#34;
    return int(((start or datetime.now()) - to_timedelta(age)).timestamp())</code></pre>
</details>
</dd>
<dt id="freshlinks.cache.hash_url"><code class="name flex">
<span>def <span class="ident">hash_url</span></span>(<span>url: str) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>Return the hash for a given <code>url</code>.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def hash_url(url: str) -&gt; str:
    &#34;&#34;&#34;Return the hash for a given `url`.&#34;&#34;&#34;
    return sha256(url.encode(&#34;utf-8&#34;)).hexdigest()</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="freshlinks.cache.LinkEntry"><code class="flex name class">
<span>class <span class="ident">LinkEntry</span></span>
<span>(</span><span>is_cached: bool = False, version: int = 1, time: int = 0, code: int = 200, err: str = '', url: str = '', links: List[str] = &lt;factory&gt;)</span>
</code></dt>
<dd>
<div class="desc"><p>LinkEntry(is_cached: 'bool' = False, version: 'int' = 1, time: 'int' = 0, code: 'int' = 200, err: 'str' = '', url: 'str' = '', links: 'List[str]' = <factory>)</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class LinkEntry:
    is_cached: bool = False
    &#34;&#34;&#34;Did this entry come from a cache?&#34;&#34;&#34;

    version: int = 1
    &#34;&#34;&#34;Entry format version.&#34;&#34;&#34;

    time: int = 0
    code: int = 200
    err: str = &#34;&#34;
    url: str = &#34;&#34;
    links: List[str] = field(default_factory=list)

    @staticmethod
    def load(data: Dict[str, Any]) -&gt; LinkEntry:
        return LinkEntry(
            is_cached=True,
            version=data[&#34;v&#34;],
            time=data[&#34;t&#34;],
            code=data[&#34;c&#34;],
            err=data.get(&#34;err&#34;, &#34;&#34;),
            url=data[&#34;url&#34;],
            links=data[&#34;links&#34;],
        )

    @property
    def ok(self) -&gt; bool:
        return self.code in [200, 301, 302]

    @property
    def json(self) -&gt; Dict[str, Any]:
        return dict(
            v=self.version,
            t=self.time,
            c=self.code,
            err=self.err,
            url=self.url,
            links=self.links,
        )</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="freshlinks.cache.LinkEntry.links"><code class="name">var <span class="ident">links</span> : List[str]</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="freshlinks.cache.LinkEntry.is_cached"><code class="name">var <span class="ident">is_cached</span> : bool</code></dt>
<dd>
<div class="desc"><p>Did this entry come from a cache?</p></div>
</dd>
<dt id="freshlinks.cache.LinkEntry.version"><code class="name">var <span class="ident">version</span> : int</code></dt>
<dd>
<div class="desc"><p>Entry format version.</p></div>
</dd>
<dt id="freshlinks.cache.LinkEntry.time"><code class="name">var <span class="ident">time</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="freshlinks.cache.LinkEntry.code"><code class="name">var <span class="ident">code</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="freshlinks.cache.LinkEntry.err"><code class="name">var <span class="ident">err</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="freshlinks.cache.LinkEntry.url"><code class="name">var <span class="ident">url</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="freshlinks.cache.LinkEntry.load"><code class="name flex">
<span>def <span class="ident">load</span></span>(<span>data: Dict[str, Any]) ‑> <a title="freshlinks.cache.LinkEntry" href="#freshlinks.cache.LinkEntry">LinkEntry</a></span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@staticmethod
def load(data: Dict[str, Any]) -&gt; LinkEntry:
    return LinkEntry(
        is_cached=True,
        version=data[&#34;v&#34;],
        time=data[&#34;t&#34;],
        code=data[&#34;c&#34;],
        err=data.get(&#34;err&#34;, &#34;&#34;),
        url=data[&#34;url&#34;],
        links=data[&#34;links&#34;],
    )</code></pre>
</details>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="freshlinks.cache.LinkEntry.ok"><code class="name">var <span class="ident">ok</span> : bool</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def ok(self) -&gt; bool:
    return self.code in [200, 301, 302]</code></pre>
</details>
</dd>
<dt id="freshlinks.cache.LinkEntry.json"><code class="name">var <span class="ident">json</span> : Dict[str, Any]</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def json(self) -&gt; Dict[str, Any]:
    return dict(
        v=self.version,
        t=self.time,
        c=self.code,
        err=self.err,
        url=self.url,
        links=self.links,
    )</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="freshlinks.cache.LinkCache"><code class="flex name class">
<span>class <span class="ident">LinkCache</span></span>
<span>(</span><span>store: Dict[str, <a title="freshlinks.cache.LinkEntry" href="#freshlinks.cache.LinkEntry">LinkEntry</a>], max_time: int = 0, path: <a title="freshlinks.cache.StrOrPath" href="#freshlinks.cache.StrOrPath">StrOrPath</a> = '~/.cache/freshlinks', preload: bool = False)</span>
</code></dt>
<dd>
<div class="desc"><p>A file-based cache for storing metadata about URLs.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class LinkCache:
    &#34;&#34;&#34;A file-based cache for storing metadata about URLs.&#34;&#34;&#34;

    path: Path
    &#34;&#34;&#34;Cache folder.&#34;&#34;&#34;

    max_time: int = 0
    &#34;&#34;&#34;Cache entries older than this are considered invalid.&#34;&#34;&#34;

    def __init__(
        self,
        store: Dict[str, LinkEntry],
        max_time: int = 0,
        path: StrOrPath = DEFAULT_PATH,
        preload: bool = False,
    ):
        self.store = store
        self.max_time = max_time if max_time &gt; 0 else int(time())
        self.path = Path(path).expanduser()
        self.path.mkdir(exist_ok=True)  # ensure cache folder exists
        if preload:
            self.preload()

    def preload(self) -&gt; None:
        for item in self.path.glob(&#34;*.json&#34;):
            self.load(item.stem)

    def load(self, hashed: str) -&gt; Optional[LinkEntry]:
        path = self.path / f&#34;{hashed}.json&#34;
        if not path.exists():
            return None

        data = ujson.loads(path.read_text())
        if data.get(&#34;t&#34;, 0) &lt; self.max_time:
            return None

        entry = LinkEntry.load(data)
        self.store[entry.url] = entry
        return entry

    def __contains__(self, url: str) -&gt; bool:
        return url in self.store or (self.path / f&#34;{hash_url(url)}.json&#34;).exists()

    def __getitem__(self, url: str) -&gt; Optional[LinkEntry]:
        try:
            return self.store[url]
        except KeyError:
            return self.load(hash_url(url))

    def __setitem__(self, url: str, entry: LinkEntry) -&gt; None:
        self.store[url] = entry
        if entry:
            (self.path / f&#34;{hash_url(url)}.json&#34;).write_text(
                ujson.dumps(
                    entry.json,
                    ensure_ascii=False,
                    escape_forward_slashes=False,
                )
            )</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="freshlinks.cache.LinkCache.path"><code class="name">var <span class="ident">path</span> : pathlib.Path</code></dt>
<dd>
<div class="desc"><p>Cache folder.</p></div>
</dd>
<dt id="freshlinks.cache.LinkCache.max_time"><code class="name">var <span class="ident">max_time</span> : int</code></dt>
<dd>
<div class="desc"><p>Cache entries older than this are considered invalid.</p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="freshlinks.cache.LinkCache.preload"><code class="name flex">
<span>def <span class="ident">preload</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def preload(self) -&gt; None:
    for item in self.path.glob(&#34;*.json&#34;):
        self.load(item.stem)</code></pre>
</details>
</dd>
<dt id="freshlinks.cache.LinkCache.load"><code class="name flex">
<span>def <span class="ident">load</span></span>(<span>self, hashed: str) ‑> Optional[<a title="freshlinks.cache.LinkEntry" href="#freshlinks.cache.LinkEntry">LinkEntry</a>]</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def load(self, hashed: str) -&gt; Optional[LinkEntry]:
    path = self.path / f&#34;{hashed}.json&#34;
    if not path.exists():
        return None

    data = ujson.loads(path.read_text())
    if data.get(&#34;t&#34;, 0) &lt; self.max_time:
        return None

    entry = LinkEntry.load(data)
    self.store[entry.url] = entry
    return entry</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="freshlinks" href="index.html">freshlinks</a></code></li>
</ul>
</li>
<li><h3><a href="#header-variables">Global variables</a></h3>
<ul class="">
<li><code><a title="freshlinks.cache.StrOrPath" href="#freshlinks.cache.StrOrPath">StrOrPath</a></code></li>
<li><code><a title="freshlinks.cache.DEFAULT_PATH" href="#freshlinks.cache.DEFAULT_PATH">DEFAULT_PATH</a></code></li>
<li><code><a title="freshlinks.cache.RE_DURATION" href="#freshlinks.cache.RE_DURATION">RE_DURATION</a></code></li>
<li><code><a title="freshlinks.cache.DURATION_UNITS" href="#freshlinks.cache.DURATION_UNITS">DURATION_UNITS</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="freshlinks.cache.to_timedelta" href="#freshlinks.cache.to_timedelta">to_timedelta</a></code></li>
<li><code><a title="freshlinks.cache.age_time" href="#freshlinks.cache.age_time">age_time</a></code></li>
<li><code><a title="freshlinks.cache.hash_url" href="#freshlinks.cache.hash_url">hash_url</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="freshlinks.cache.LinkEntry" href="#freshlinks.cache.LinkEntry">LinkEntry</a></code></h4>
<ul class="two-column">
<li><code><a title="freshlinks.cache.LinkEntry.load" href="#freshlinks.cache.LinkEntry.load">load</a></code></li>
<li><code><a title="freshlinks.cache.LinkEntry.ok" href="#freshlinks.cache.LinkEntry.ok">ok</a></code></li>
<li><code><a title="freshlinks.cache.LinkEntry.json" href="#freshlinks.cache.LinkEntry.json">json</a></code></li>
<li><code><a title="freshlinks.cache.LinkEntry.links" href="#freshlinks.cache.LinkEntry.links">links</a></code></li>
<li><code><a title="freshlinks.cache.LinkEntry.is_cached" href="#freshlinks.cache.LinkEntry.is_cached">is_cached</a></code></li>
<li><code><a title="freshlinks.cache.LinkEntry.version" href="#freshlinks.cache.LinkEntry.version">version</a></code></li>
<li><code><a title="freshlinks.cache.LinkEntry.time" href="#freshlinks.cache.LinkEntry.time">time</a></code></li>
<li><code><a title="freshlinks.cache.LinkEntry.code" href="#freshlinks.cache.LinkEntry.code">code</a></code></li>
<li><code><a title="freshlinks.cache.LinkEntry.err" href="#freshlinks.cache.LinkEntry.err">err</a></code></li>
<li><code><a title="freshlinks.cache.LinkEntry.url" href="#freshlinks.cache.LinkEntry.url">url</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="freshlinks.cache.LinkCache" href="#freshlinks.cache.LinkCache">LinkCache</a></code></h4>
<ul class="">
<li><code><a title="freshlinks.cache.LinkCache.preload" href="#freshlinks.cache.LinkCache.preload">preload</a></code></li>
<li><code><a title="freshlinks.cache.LinkCache.load" href="#freshlinks.cache.LinkCache.load">load</a></code></li>
<li><code><a title="freshlinks.cache.LinkCache.path" href="#freshlinks.cache.LinkCache.path">path</a></code></li>
<li><code><a title="freshlinks.cache.LinkCache.max_time" href="#freshlinks.cache.LinkCache.max_time">max_time</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>